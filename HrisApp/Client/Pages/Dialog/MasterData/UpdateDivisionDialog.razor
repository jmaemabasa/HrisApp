@inject IDivisionService DivisionService
@inject SweetAlertService Swal
@inject NavigationManager navigationManager
@inject IJSRuntime jsRuntime

<MudDialog>
    <DialogContent>
        <MudTextField Label="Name" @bind-Value="division.Name"></MudTextField>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
        <MudButton Color="Color.Primary" OnClick="UpdateArea">Save</MudButton>
    </DialogActions>
</MudDialog>


@code {
#nullable disable

    [CascadingParameter] MudDialogInstance MudDialog { get; set; }
    [Parameter]
    public int Id { get; set; }


    private DivisionT division = null;


    void Cancel() => MudDialog.Cancel();


    protected override async Task OnParametersSetAsync()
    {
        division = DivisionService.DivisionTs.Find(d => d.Id == Id);
    }

    async Task UpdateArea()
    {
        if (division == null)
            return;

        MudDialog.Close();

        var confirmResult = await Swal.FireAsync(new SweetAlertOptions
            {
                Title = "Confirmation",
                Text = "Are you sure you want to update the " + division.Name + "?",
                Icon = SweetAlertIcon.Question,
                ShowCancelButton = true,
                ConfirmButtonText = "Yes",
                CancelButtonText = "No"
            });

        if (confirmResult.IsConfirmed)
        {
            await DivisionService.UpdateDivision(division);
            await Swal.FireAsync(new SweetAlertOptions
                {
                    Text = division.Name + " updated Successfully!",
                    Icon = SweetAlertIcon.Success
                });
            await jsRuntime.InvokeVoidAsync("location.reload");
            navigationManager.NavigateTo("/division");
        }
    }
}
